<?xml version="1.0" standalone="no"?>

<kickstart>


	<description>
	make sure that an initrd is part of grub.conf
	</description>

	<copyright>
	Copyright (c) 2000 - 2012 The Regents of the University of California.
	All rights reserved. Rocks(r) v5.5/v6.0 www.rocksclusters.org
	
	</copyright>

	<changelog>
	$Log: kernel-org-grub.xml,v $
	Revision 1.1  2012/07/15 18:55:55  phil
	Make a roll that supports kernel.org kernels
	
	</changelog>

<!-- only do this post of kernel_org_grub condition is set -->
<post cond="kernel_org_grub">
<!--Create an initrd in grub.conf if necessary --> 
/opt/rocks/sbin/check-initrd

if [ ! -d /tmp/kernel-org ]; then mkdir  /tmp/kernel-org; fi

/bin/cp /boot/grub/grub.conf /tmp/kernel-org

<!-- replace root=UUID=uuid with root=/dev/... in the grub.conf --> 
if [ -f /tmp/kernel-org/grub.conf ]; then
<file name="/boot/grub/grub.conf" 
	expr="/opt/rocks/sbin/uuid-to-dev /tmp/kernel-org/grub.conf"/>
fi
</post>
</kickstart>
